# Backend-приложение для автоматизации закупок

Это backend для сервиса автоматизации закупок в розничной сети. Приложение предоставляет REST API для взаимодействия с пользователями (покупатели и поставщики), управления каталогом товаров, обработки заказов и асинхронного выполнения длительных задач.

## Основные технологии

- **Backend:** Python, Django, Django REST Framework
- **Асинхронные задачи:** Celery
- **Брокер сообщений:** Redis
- **Контейнеризация:** Docker, Docker Compose
- **Работа с данными:** PyYAML, Requests, ujson

## Ключевые возможности

- **Аутентификация и регистрация** пользователей (покупатели и поставщики).
- **Управление каталогом товаров:**
  - Импорт прайс-листов поставщиков из YAML-файлов.
  - Возможность добавления настраиваемых характеристик к товарам.
- **Система заказов:**
  - Формирование корзины.
  - Оформление заказа.
  - Отслеживание статуса заказа.
- **Асинхронная обработка:**
  - Все email-уведомления (регистрация, смена статуса заказа) отправляются в фоновом режиме.
  - Импорт прайс-листов запускается как фоновая задача через админ-панель.
- **Продвинутая админ-панель:**
  - Удобное управление моделями.
  - Кастомное действие для запуска импорта прайс-листов.

---

## Инструкция по запуску через Docker

Это рекомендуемый способ запуска проекта.

### Требования

- Docker
- Docker Compose

### Шаги для запуска

1.  **Склонируйте репозиторий:**
    ```bash
    git clone https://github.com/cevtrem/python-final-diplom.git
    cd python-final-diplom
    ```

2.  **Запустите сервисы:**
    В корневой папке проекта выполните команду:
    ```bash
    docker-compose up --build
    ```
    Эта команда соберет образ приложения и запустит все сервисы: `backend`, `redis` и `celery`.

3.  **Выполните миграции базы данных:**
    **В новом окне терминала** выполните команду, чтобы создать таблицы в базе данных:
    ```bash
    docker-compose exec backend python manage.py migrate
    ```

4.  **Создайте суперпользователя:**
    Для доступа к админ-панели создайте администратора:
    ```bash
    docker-compose exec backend python manage.py createsuperuser
    ```
    Следуйте инструкциям в консоли, чтобы задать логин, email и пароль.

5.  **Проект готов к работе!**
    - API будет доступно по адресу: `http://localhost:8000`
    - Админ-панель: `http://localhost:8000/admin/`

### Остановка проекта

Чтобы остановить все запущенные сервисы, вернитесь в терминал, где выполнялась команда `docker-compose up`, и нажмите `Ctrl+C`.

---

## Тестирование импорта прайс-листа

1.  Зайдите в админ-панель (`http://localhost:8000/admin/`).
2.  Перейдите в раздел "Магазины" (`Shops`).
3.  Откройте магазин, для которого хотите выполнить импорт.
4.  В поле "Ссылка" (`url`) укажите путь к файлу прайс-листа. Для тестового файла, который есть в проекте, используйте путь внутри контейнера:
    ```
    file:///app/data/test_price.yaml
    ```
5.  Сохраните изменения.
6.  Вернитесь к списку магазинов, выберите нужный магазин (поставьте галочку) и в выпадающем меню "Действие" выберите "Обновить прайс-лист", затем нажмите "Выполнить".
7.  В логах `celery` контейнера вы увидите статус выполнения задачи.